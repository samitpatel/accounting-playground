<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Transaction Manager</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-card">
                <h1 class="login-logo">Business Manager</h1>
                <p class="login-subtitle">Manage your transactions with ease</p>

                <!-- Login Form -->
                <form id="login-form" class="auth-form">
                    <h2>Login</h2>
                    <div class="form-group">
                        <label for="login-username">Username</label>
                        <input type="text" id="login-username" class="input" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" class="input" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                    <p class="auth-switch">
                        Don't have an account?
                        <a href="#" id="show-register">Register</a>
                    </p>
                </form>

                <!-- Register Form -->
                <form id="register-form" class="auth-form" style="display: none;">
                    <h2>Register</h2>
                    <div class="form-group">
                        <label for="register-username">Username</label>
                        <input type="text" id="register-username" class="input" required minlength="3" autocomplete="username">
                        <small>Minimum 3 characters</small>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" class="input" required minlength="6" autocomplete="new-password">
                        <small>Minimum 6 characters</small>
                    </div>
                    <div class="form-group">
                        <label for="register-confirm">Confirm Password</label>
                        <input type="password" id="register-confirm" class="input" required autocomplete="new-password">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Register</button>
                    <p class="auth-switch">
                        Already have an account?
                        <a href="#" id="show-login">Login</a>
                    </p>
                </form>

                <div id="auth-error" class="auth-error" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Header Navigation -->
    <header class="header" id="main-header" style="display: none;">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">Business Manager</h1>
                <nav class="nav">
                    <button class="nav-btn active" data-view="dashboard">Dashboard</button>
                    <button class="nav-btn" data-view="transactions">Transactions</button>
                </nav>
                <div class="user-menu">
                    <div class="company-selector">
                        <button class="btn btn-secondary btn-small" id="company-selector-btn">
                            <span id="current-company-name">Loading...</span> â–¾
                        </button>
                    </div>
                    <span class="user-name" id="current-user-name"></span>
                    <button class="btn btn-secondary btn-small" id="logout-btn">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main" id="main-content" style="display: none;">
        <div class="container">
            <!-- Dashboard View -->
            <section id="dashboard-view" class="view active">
                <div class="view-header">
                    <h2>Dashboard</h2>
                    <div class="date-filter">
                        <select id="dashboard-date-range">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 90 days</option>
                            <option value="365">Last year</option>
                            <option value="all">All time</option>
                        </select>
                    </div>
                </div>

                <!-- Summary Cards -->
                <div class="summary-cards">
                    <div class="card summary-card">
                        <div class="card-icon income-icon">â†‘</div>
                        <div class="card-content">
                            <div class="card-label">Total Income</div>
                            <div class="card-value" id="total-income">$0.00</div>
                        </div>
                    </div>
                    <div class="card summary-card">
                        <div class="card-icon expense-icon">â†“</div>
                        <div class="card-content">
                            <div class="card-label">Total Expenses</div>
                            <div class="card-value" id="total-expenses">$0.00</div>
                        </div>
                    </div>
                    <div class="card summary-card">
                        <div class="card-icon balance-icon">â‰ˆ</div>
                        <div class="card-content">
                            <div class="card-label">Net Balance</div>
                            <div class="card-value" id="net-balance">$0.00</div>
                        </div>
                    </div>
                    <div class="card summary-card">
                        <div class="card-icon count-icon">#</div>
                        <div class="card-content">
                            <div class="card-label">Transactions</div>
                            <div class="card-value" id="transaction-count">0</div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="card chart-card">
                        <h3>Expenses by Category</h3>
                        <canvas id="category-pie-chart"></canvas>
                    </div>
                    <div class="card chart-card">
                        <h3>Income vs Expenses</h3>
                        <canvas id="income-expense-chart"></canvas>
                    </div>
                    <div class="card chart-card full-width">
                        <h3>Top Spending Categories</h3>
                        <canvas id="top-categories-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Transactions View -->
            <section id="transactions-view" class="view">
                <div class="view-header">
                    <h2>Transactions</h2>
                    <button class="btn btn-primary" id="add-transaction-btn">+ Add Transaction</button>
                </div>

                <!-- Filters -->
                <div class="card filters-card">
                    <div class="filters">
                        <input type="text" id="search-input" placeholder="Search transactions..." class="input">
                        <select id="filter-type" class="input">
                            <option value="">All Types</option>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                        <select id="filter-category" class="input">
                            <option value="">All Categories</option>
                        </select>
                        <input type="date" id="filter-date-start" class="input" placeholder="Start date">
                        <input type="date" id="filter-date-end" class="input" placeholder="End date">
                        <button class="btn btn-secondary" id="clear-filters-btn">Clear</button>
                        <button class="btn btn-primary" id="import-csv-btn">Import QuickBooks</button>
                        <button class="btn btn-secondary" id="export-csv-btn">Export CSV</button>
                        <input type="file" id="csv-file-input" accept=".csv" style="display: none;">
                    </div>
                </div>

                <!-- Transactions Table -->
                <div class="card table-card">
                    <div class="table-container">
                        <table class="transactions-table">
                            <thead>
                                <tr>
                                    <th data-sort="date">Date <span class="sort-icon">â†•</span></th>
                                    <th data-sort="type">Type <span class="sort-icon">â†•</span></th>
                                    <th data-sort="category">Category <span class="sort-icon">â†•</span></th>
                                    <th>Description</th>
                                    <th>Tags</th>
                                    <th data-sort="amount">Amount <span class="sort-icon">â†•</span></th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="transactions-tbody">
                                <!-- Transactions will be inserted here -->
                            </tbody>
                        </table>
                        <div id="empty-state" class="empty-state" style="display: none;">
                            <p>No transactions yet. Click "Add Transaction" to get started!</p>
                        </div>
                    </div>
                    <div class="pagination">
                        <button class="btn btn-secondary" id="prev-page-btn" disabled>Previous</button>
                        <span id="page-info">Page 1 of 1</span>
                        <button class="btn btn-secondary" id="next-page-btn" disabled>Next</button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Add/Edit Transaction Modal -->
    <div id="transaction-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Add Transaction</h3>
                <button class="modal-close" id="modal-close-btn">&times;</button>
            </div>
            <form id="transaction-form">
                <input type="hidden" id="transaction-id">

                <div class="form-group">
                    <label for="transaction-type">Type *</label>
                    <select id="transaction-type" class="input" required>
                        <option value="income">Income</option>
                        <option value="expense">Expense</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="transaction-amount">Amount *</label>
                    <input type="number" id="transaction-amount" class="input" step="0.01" min="0.01" required>
                </div>

                <div class="form-group">
                    <label for="transaction-category">Category *</label>
                    <select id="transaction-category" class="input" required>
                        <option value="">Select category</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="transaction-date">Date *</label>
                    <input type="date" id="transaction-date" class="input" required>
                </div>

                <div class="form-group">
                    <label for="transaction-description">Description</label>
                    <textarea id="transaction-description" class="input" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label for="transaction-tags">Tags (comma-separated)</label>
                    <input type="text" id="transaction-tags" class="input" placeholder="e.g., client, project-alpha">
                    <div id="tag-suggestions" class="tag-suggestions"></div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Transaction</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this transaction? This action cannot be undone.</p>
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancel-delete-btn">Cancel</button>
                <button class="btn btn-danger" id="confirm-delete-btn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Company Selector Modal -->
    <div id="company-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Select Company</h3>
                <button class="modal-close" id="company-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="company-list" id="company-list">
                    <!-- Companies will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Import Preview Modal -->
    <div id="import-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Import QuickBooks Transactions</h3>
                <button class="modal-close" id="import-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="import-instructions" class="import-section">
                    <h4>ðŸ“‹ QuickBooks CSV Format</h4>
                    <p>Your CSV file should have these columns:</p>
                    <ul>
                        <li><strong>Date</strong> - Transaction date (MM/DD/YYYY or YYYY-MM-DD)</li>
                        <li><strong>Type</strong> - Transaction type (Invoice, Payment, Bill, Expense, Deposit, etc.)</li>
                        <li><strong>Name</strong> - Customer or Vendor name</li>
                        <li><strong>Memo/Description</strong> - Transaction details</li>
                        <li><strong>Account</strong> - Account name (maps to our categories)</li>
                        <li><strong>Amount</strong> - Transaction amount (positive or negative)</li>
                    </ul>
                    <p><strong>Note:</strong> Income types (Invoice, Deposit, Payment Received) will be imported as Income. Expense types (Bill, Expense, Check) will be imported as Expenses.</p>
                </div>

                <div id="import-preview" class="import-section" style="display: none;">
                    <h4>Preview Transactions</h4>
                    <p id="import-summary"></p>
                    <div class="import-preview-table">
                        <table class="transactions-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Category</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody id="import-preview-tbody">
                                <!-- Preview rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="import-error" class="import-error" style="display: none;"></div>
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" id="import-cancel-btn">Cancel</button>
                <button class="btn btn-primary" id="import-confirm-btn" style="display: none;">Import <span id="import-count"></span> Transactions</button>
            </div>
        </div>
    </div>

    <!-- Floating Action Button (Mobile) -->
    <button class="fab" id="fab-add-btn" style="display: none;">+</button>

    <script src="app.js"></script>
</body>
</html>
